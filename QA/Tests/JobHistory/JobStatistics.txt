
*** Settings ***
| Documentation | Verify that 
| Metadata      | Authors	| Daniel Oliver	
| Force Tags		| in-progress | team.method
#| Suite Setup		| Create Suite Setup Data
#| Test Teardown 	| Run Keyword if Test Failed	| Capture Page Screenshot
#| Suite Teardown	| Delete the Objects created in the Suite then Close All Browsers


*** Variables ***

| ${WorkspaceName}	          | LDAP Sync
| ${IntegrationName1}         | Job History Statistics - Append/Overlay without Errors
| ${IntegrationName2}         | Job History Statistics - Overlay without Errors
| ${IntegrationName3}         | Job History Statistics - Nested Managers without Errors
| ${IntegrationName4}         | Job History Statistics - Append/Overlay with Errors


*** Test Cases ***

| Import Statistics are blank before the Job is started
| | [Documentation] | Verify that the Import Statistics are both zero for Jobs that have not yet started.
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Preconditions:
| | ... | 1. ${IntegrationName1} is a Custodian Import with Append/Overlay that will not cause any errors, and has about 10 records
| | ... |
| | ... | Steps:
| | ... | 1. View Integration Point | ${IntegrationName1}
| | ... | 2. Click | Import Now
| | ... | 3. View the associated Job History before the job starts
| | ... | 
| | ... | Expected Results
| | ... | Verify that both the Records Imported and Records with Errors fields have a blank value


| Records Imported is Updated while the job is running
| | [Documentation] | Verify that the Import Statistics are Updated while the Job is in progress.
| | ...				| [id] d4746d91-dfa7-11e4-ae93-90b11c6c5ae4
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. View the Job History for ${IntegrationName1} while the import is in progress
| | ... | 2. Periodically refresh the page 
| | ... | 
| | ... | Expected Results
| | ... | Verify that the Records fields are updated while the job is running


| Records Imported is correct once the Job is complete
| | [Documentation] | Verify that the Import Statistics are Updated while the Job is in progress.
| | ...				| [id] d9d03170-dfa7-11e4-82c4-90b11c6c5ae4
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. View the Job History for ${IntegrationName1} after the import is complete
| | ... | 
| | ... | Expected Results
| | ... | 1. Verify that the Records Imported field's value matches the number of custodians who were imported/updated
| | ... | 2. Verify that the Records with Errors field's value matches the number of custodians who had errors


| Overlay Only Imports show the correct Records Imported Value
| | [Documentation] | Verify that an Overlay Only Imports show the correct Records Imported Value.
| | ...				| [id] dc9089f0-dfa7-11e4-a89f-90b11c6c5ae4
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Preconditions:
| | ... | 1. ${IntegrationName2} is a Custodian Import with Overlay that will not cause any errors
| | ... |
| | ... | Steps:
| | ... | 1. View Integration Point | ${IntegrationName2}
| | ... | 2. Click | Import Now
| | ... | 3. Wait for the job to complete
| | ... | 4. Click | Import Now
| | ... | 5. View the most recent Job History for ${IntegrationName2} after the import is complete
| | ... | 
| | ... | Expected Results
| | ... | Verify that the Records Imported field's value matches the number of custodians from the RIP


| Records Imported with nested Managers (Excluded) includes the Managers in the count
| | [Documentation] | Verify that the Records Imported with nested Managers includes the Managers in the count.
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Preconditions:
| | ... | 1. ${IntegrationName3} is a Custodian Import with Append/Overlay that will not cause any errors, and has about 5 records who have Managers in other folders/different departments.
| | ... | 2. The import is restricted to the Custodians (i.e. the filter excludes the Managers)
| | ... | 3. Import Nested is set to Yes
| | ... |
| | ... | Steps:
| | ... | 1. View Integration Point | ${IntegrationName3}
| | ... | 2. Click | Import Now
| | ... | 3. View the Job History for ${IntegrationName3} after the import is complete
| | ... | 
| | ... | Expected Results
| | ... | Verify that the Records Imported value equals the sum of the non-managers and managers


| Records Imported with nested Managers (Included) includes the Managers in the count and one additional count per linked Manager
| | [Documentation] | Verify that the Records Imported with nested Managers includes the Managers in the count.
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Preconditions:
| | ... | 1. ${IntegrationName7} is a Custodian Import with Append/Overlay that will not cause any errors, and has about 5 records who have Managers in other folders/different departments.
| | ... | 2. The import is restricted to the Custodians and Managers (i.e. the filter includes the Managers)
| | ... | 3. Import Nested is set to Yes
| | ... |
| | ... | Steps:
| | ... | 1. View Integration Point | ${IntegrationName7}
| | ... | 2. Click | Import Now
| | ... | 3. View the Job History for ${IntegrationName7} after the import is complete
| | ... | 
| | ... | Expected Results
| | ... | Verify that the Records Imported value equals the sum of the non-managers and managers, plus one for each manager-custodian link


| Records Imported with non-nested Managers (Excluded) includes the Managers in the count
| | [Documentation] | Verify that the Records Imported with nested Managers includes the Managers in the count when the filter string excludes the Managers.
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Preconditions:
| | ... | 1. ${IntegrationName5} is a Custodian Import with Append/Overlay that will not cause any errors, and has about 5 records who have Managers in the same connection path.
| | ... | 2. The import is restricted to the Custodians (i.e. the filter excludes the Managers)
| | ... | 3. Import Nested is enabled
| | ... |
| | ... | Steps:
| | ... | 1. View Integration Point | ${IntegrationName5}
| | ... | 2. Click | Import Now
| | ... | 3. View the Job History for ${IntegrationName5} after the import is complete
| | ... | 
| | ... | Expected Results
| | ... | Verify that the Records Imported value equals the sum of the non-managers and managers


| Records Imported with non-nested Managers (Included) includes the Managers in the count and one additional count per linked Manager
| | [Documentation] | Verify that the Records Imported with nested Managers includes the Managers in the count when the filter string includes the Managers.
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Preconditions:
| | ... | 1. ${IntegrationName6} is a Custodian Import with Append/Overlay that will not cause any errors, and has about 5 records who have Managers in the same connection path
| | ... | 2. The filter restriction allows for the import of both the Custodians AND the Managers,
| | ... | 3. Import Nested is enabled
| | ... |
| | ... | Steps:
| | ... | 1. View Integration Point | ${IntegrationName6}
| | ... | 2. Click | Import Now
| | ... | 3. View the Job History for ${IntegrationName6} after the import is complete
| | ... | 
| | ... | Expected Results
| | ... | Verify that the Records Imported value equals the sum of the non-managers and managers, plus one for each manager that was linked


| Imports with Errors show the correct Records Imported, Records with Errors counts
| | [Documentation] | Verify that Imports that have Errors show the correct values for both the Records Imported, and Records with Errors fields
| | [Tags]			| manual
| | Run the following manual steps:
| | ... | Preconditions:
| | ... | 1. ${IntegrationName4} is a Custodian Import that will import some custodians, but fail on others due to the Unique Identifier being set to Department (which all Custodians will share)
| | ... |
| | ... | Steps:
| | ... | 1. View Integration Point | ${IntegrationName4}
| | ... | 2. Click | Import Now
| | ... | 3. View the Job History for ${IntegrationName4} after the import is complete
| | ... | 
| | ... | Expected Results
| | ... | 1. Verify that the Records Imported count is correct: 1
| | ... | 2. Verify that the Records with Errors is correct: One for each other Custodian that has the same department


*** Settings ***
| Library	| ${KEYWORD_DIR}/ManualKeywords.py
| Library	| ${KEYWORD_DIR}/kWebDriver.py