	
*** Settings ***
| Documentation		| Verify the mapping of LDAP to RLH fields in Map LDAP Fields from Settings
| Metadata		    | Authors	| Daniel Oliver	| William Sehy
| Suite Setup		| Log	| This is the suite setup keyword.
| Suite Teardown	| Log	| This is the suite teardown keyword.
| Force Tags		| manual	| in-progress	| team.method
| Test Setup		| Open Browser	| ${ROOT}
| Test Teardown 	| Close All Browsers


*** Variables ***


*** Test Cases ***


| Error Message displayed when trying to load Custodians with no field map data
| | [Documentation]	| Verify the correct Error Message is displayed when trying to load Custodians with no field map data
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. LDAP Details are configured, but the field map is blank
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click	| Load Custodians
| | ... | 
| | ... | Expected Results:
| | ... | Verify error message is displayed "Cannot Load Custodians because there are no LDAP Fields Mapped."


| The Required Fields can be Mapped
| | [Documentation]	| Verify that the required fields can be mapped
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. LDAP Details are configured
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click | Map LDAP Fields
| | ... | 3. Assign the following LDAP and RLH fields
| | ... | mail      \| Email
| | ... | givenname \| First Name
| | ... | sn        \| Last Name
| | ... | objectsid \| UniqueID
| | ... | 4. Click	| Save
| | ... | 5. Click | Map LDAP Fields
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that the fields are displayed as entered


| Non Matching field types shown an error in Admin mode after Loading Custodians
| | [Documentation]	| An Admin error is shown when miss-matching field types are mapped and Custodians are loaded
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. LDAP Details are configured
| | ... | 2. The required fields have been mapped
| | ... | 3. A custodian has data in their LDAP Company field
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click | Map LDAP Fields
| | ... | 3. Assign the additional following LDAP and RLH fields
| | ... | 4. company   \| Employment Start Date #Any miss-matching fields will do
| | ... | 5. Click		| Save
| | ... | 6. Click      | Load Custodians
| | ... | 7. View LDAP import Error in Admin mode
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify an error is displayed similar to "The value of the field <Field Name> (<Field Value>) could not be converted to a <type> for custodian <email>."

 
| An unmapped field is present in the LDAP List displays an error on Save
| | [Documentation]	| Verify that an error is displayed when trying to save with an additional field listed in the LDAP side of the map
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. LDAP Details are configured
| | ... | 2. The required fields have been mapped
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click | Map LDAP Fields
| | ... | 3. Assign an additional field in the LDAP list
| | ... | 4. Click		| Save
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify error is displayed "An unmapped field is present. Please make sure all fields to be loaded have a corresponding mapped field."
| | ... | 2. Verify that the LDAP Map Fields screen is still displayed

| An unmapped field is present in the RLH List displays an error on Save
| | [Documentation]	| Verify that an error is displayed when trying to save with an additional field listed in the RLH side of the map
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. LDAP Details are configured
| | ... | 2. The required fields have been mapped
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click | Map LDAP Fields
| | ... | 3. Assign an additional field in the RLH list
| | ... | 4. Click		| Save
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify error is displayed "An unmapped field is present. Please make sure all fields to be loaded have a corresponding mapped field."
| | ... | 2. Verify that the LDAP Map Fields screen is still displayed



| Can save post unmapped field message
| | [Documentation]	| Verify that the map can be saved after encountering the unmapped fields message
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. LDAP Details are configured
| | ... | 2. The required fields have been mapped
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click | Map LDAP Fields
| | ... | 3. Assign an additional field in the RLH list
| | ... | 4. Click		| Save
| | ... | 5. Assign a mathcing field in the LDAP list
| | ... | 6. Click		| Save
| | ... | 7. Click      | Map LDAP Fields
| | ... |
| | ... | Expected Results:
| | ... | 1. Verify that the Map has been saved with the new fields added.


| LDAP Map Fields UI
| | [Documentation]	| Verify that the LDAP Map Fields UI is correct
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click | Map LDAP Fields
| | ... |
| | ... | Expected Results:
| | ... | 1. Verify that the heading is LDAP Map fields
| | ... | 2. The first list is titled LDAP Fields and contains all the fields in LDAP
| | ... | 3. The second list is the selected LDAP fields
| | ... | 4. The third list is the selected RLH fields
| | ... | 5. The fourth list is titled Confirguration fields and contains the following:
| | ... | - Current Title
| | ... | - Department
| | ... | - Email
| | ... | - Employee Number
| | ... | - Employess Status
| | ... | - Employment End Date
| | ... | - Employment Start Date
| | ... | - First Name
| | ... | - Last Name
| | ... | - Past Department
| | ... | - Past Title
| | ... | - Phone Number
| | ... | - Secondate Email
| | ... | - Unique ID



| Updates to the Field Map are used in future imports
| | [Documentation]	| Add a new field, run. Remove the new field, and add another field, run
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. LDAP Details are configured
| | ... | 2. The required fields have been mapped
| | ... | 3. Identify two LDAP fields that have data that can be imported
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Settings tab
| | ... | 2. Click | Map LDAP Fields
| | ... | 3. Assign a valid additional field into both lists and Save.
| | ... | 4. Click | Load Custodians
| | ... | 5. Click | Map LDAP Fields
| | ... | 6. Remove the fields added in step 3.
| | ... | 7. Assign a different valid additional field into both lists and Save.
| | ... | 8. Add a new Custodian in LDAP who does not have data in the field from step 3, but does have data from the field in step 7
| | ... | 9. Click | Load Custodians
| | ... | 10. View the new Custodian in RLH
| | ... |
| | ... | Expected Results:
| | ... | 1. Verify that the data from step 3 is not populated
| | ... | 2. Verify that the data from step 7 is populated


*** Keywords ***

| Configure LDAP with the Following Values
| | [ARGUMENTS]	| ${LDAPDomain} 	| ${LDAPUsername}	| ${LDAPPassword}
| | ... | 1. Click			| Edit
| | ... | 2. Enter the LDAP Domain	| testing.corp
| | ... | 3. Enter the LDAP Username	| rellockdown
| | ... | 4. Enter the LDAP Password	| P@ssw0rd@1
| | ... | 5. Click			| Save

| Use the Mapping Widget to Map a Method Field to an LDAP Field
| | [ARGUMENTS]	| ${MethodField}	| ${LDAPField} | 
| | Run the following manual steps:
| | ... | 1. Double Click		| ${MethodField}
| | ... | 2. Double Click		| ${LDAPField}

| Create Basic Method LDAP Mapping
| | [Documentation]	| Go to the Projects > Configuration tab and map LDAP fields to Method People fields
| | Select Tab		| Projects
| | Select Sub-Tab	| Configuration
| | Click the Button	| LDAP Settings
| | Map the Fields	| Objectguid	| Unique ID
| | Map the Fields	| name		| First Name
| | Map the Fields	| sn		| Last Name
| | Map the Fields	| mail		| Email
| | Map the Fields	| countrycode	| Department
| | Click the Button	| Save

| Match LDAP Data Types and Corresponding Method Fields
| | ... | 1. For each item in the following table: Double click the matching value from the left-hand column
| | ... | 2. For each item in the following table: Double the matching value from teh right-hand column 
| | ... |	MethodField1	|	displayName			| String (Unicode)
| | ... |	MethodField2	|	allowedAttributes		| Object Identifier (OID)
| | ... |	MethodField3	|	...				| Case Sensitive String
| | ... |	MethodField4	|	legacyExchangeDN		| CaseIgnoreString
| | ... |	MethodField5	|	serialNumber			| String (Printable)
| | ... |	MethodField6	|	internationalISDNNumber		| String Numberic
| | ... |	MethodField7	|	authOrig			| Distinguished Name with Binary
| | ... |	MethodField8	|	isDeleted			| Boolean
| | ... |	MethodField9	|	countryCode			| Integer
| | ... |	MethodField10	|	jpegphoto			| String Octet
| | ... |	MethodField11	|	...				| UTC Time
| | ... |	MethodField12	|	modifyTimeStamp			| Generalized Time
| | ... |	MethodField13	|	...				| Presentation Address
| | ... |	MethodField14	|	assistant			| Distinguished Name
| | ... |	MethodField15	|	msExchSupervisionUserLink	| Distinguished Name with String
| | ... |	MethodField16	|	lastLogoff			| Large Integer
| | ... |	MethodField17	|	...				| OR-Name
| | ... |	MethodField18	|	tokenGroups			| SID
| | ... |	MethodField19	|	...				| Security Descriptor


*** Settings ***
| Library	| ${KEYWORD_DIR}/ManualKeywords.py
| Library	| ${KEYWORD_DIR}/kWebDriver.py
| Resource	| ${KEYWORD_DIR}/Relativity/Shared/RelativityKeywords.txt
| Resource	| ${METHOD_KEYWORD_DIR}/NavigationKeywords.txt