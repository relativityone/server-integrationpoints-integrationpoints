
*** Settings ***
| Documentation		| This series of testcases cover the manual configuration of an LDAP server 
| Metadata		| Authors	| Aaron Spruill 	| Melissa Kelley-Windisch
| Force Tags		| manual	| in-progress	| sprint-3	| uaa127	| team.method
| Suite Setup		| Log	| This is the suite setup keyword.
| Test Setup		| Open Browser	| ${ROOT}
| Test Teardown		| Close All Browsers
| Suite Teardown	| Log	| This is the suite teardown keyword.


*** Variables ***

| ${WorkspaceName}	| Method-AS
| ${ProjectOwnerEmail}	| milylitest+1@gmail.com
| ${Password}		| Test1234!
| ${LDAPDomain}		| testing.corp
| ${LDAPUsername}	| rellockdown
| ${LDAPPassword}	| P@ssw0rd@1
 

*** Test Cases ***


| Test an Invalid  LDAP configuration
| | [Documentation]	| This testcase utilizes the Method LDAP Configuration to connect to a default LDAP Server
| | ... 		| where no LDAP server exists and uses the Test LDAP Settings button to force an error.
| | ...				| [id] 129a8361-a89f-11e4-a320-b8ca3a83048f
| | Run the following manual steps
| | ... | Pre-conditions:
| | ... | 1. Have a valid LDAP Map
| | ... | 
| | ... | Steps:
| | ... | 1. Change the Default LDAP Configuration	| .\administrator	| Password1!
| | ... | 2. Configure LDAP with the Following Values	| ${empty}	| ${empty}	| ${empty}
| | ... | 3. Click	| Test LDAP Settings
| | ... | 
| | ... | Expected Results:
| | ... | Verify that an error "Relativity Legal Hold was unable to connect to LDAP. (The server is not operational. ) Please contact your system administrator." displays
| | ... | 
| | ... | Teardown
| | ... | 1. Change the Default LDAP Configuration	| testing\rellockdown	| P@ssw0rd@1


| Test an Invalid LDAP configuration due to invalid domain
| | [Documentation]	| This testcase utilizes the Method LDAP Configuration to attempt to connect to an LDAP Server
| | ... 		| using an invalid domain. The Test LDAP Settings button is used to verify the connection.
| | ...				| [id] 129a8362-a89f-11e4-8983-b8ca3a83048f
| | Run the following manual steps
| | ... | Pre-conditions:
| | ... | 1. No LDAP server configured on the local network
| | ... | 
| | ... | Steps:
| | ... | 1. Login and Navigate to the Configuration tab
| | ... | 2. Configure LDAP with the Following Values	| ABC.ABC	| rellockdown	| P@ssw0rd@1
| | ... | 3. Click	| Test LDAP Settings
| | ... | 
| | ... | Expected Results:
| | ... | Verify that the error "Relativity Legal Hold was unable to connect to LDAP. (The server is not operational. ) Please contact your system administrator." displays 


| Test an Invalid LDAP configuration due to invalid username
| | [Documentation]	| This testcase utilizes the Method LDAP Configuration to attempt to connect to an LDAP Server
| | ... 		| using an invalid username. The Test LDAP Settings button is used to verify the connection.
| | ...				| [id] 129a8363-a89f-11e4-beb9-b8ca3a83048f
| | Run the following manual steps
| | ... | Pre-conditions:
| | ... | 1. No LDAP server configured on the local network
| | ... | 
| | ... | Steps:
| | ... | 1. Login and Navigate to the Configuration tab
| | ... | 2. Configure LDAP with the Following Values	| testing.corp	| invalidusername	| P@ssw0rd@1
| | ... | 3. Click	| Test LDAP Settings
| | ... | 
| | ... | Expected Results:
| | ... | Verify that the error "Relativity Legal Hold was unable to connect to LDAP. (Logon failure: unknown user name or bad password. ) Please contact your system administrator." displays


| Test an Invalid LDAP configuration due to invalid password
| | [Documentation]	| This testcase utilizes the Method LDAP Configuration to attempt to connect to an LDAP Server
| | ... 		| using an invalid password. The Test LDAP Settings button is used to verify the connection.
| | ...				| [id] 129a8364-a89f-11e4-9b21-b8ca3a83048f
| | Run the following manual steps
| | ... | Pre-conditions:
| | ... | 1. No LDAP server configured on the local network
| | ... | 
| | ... | Steps:
| | ... | 1. Login and Navigate to the Configuration tab
| | ... | 2. Configure LDAP with the Following Values	| testing.corp	| rellockdown	| invalidpassword
| | ... | 3. Click	| Test LDAP Settings
| | ... | 
| | ... | Expected Results:
| | ... | Verify that the error "Relativity Legal Hold was unable to connect to LDAP. (Logon failure: unknown user name or bad password. ) Please contact your system administrator." displays


*** Keywords ***

| Change the Default LDAP Configuration
| | [ARGUMENTS]		| ${Username}	| ${Password}
| | Run the following manual steps
| | ... | 1. Remote in to the environment's box
| | ... | 2. Open the Internet Information Services (IIS) Manager
| | ... | 3. In the Connections pane open expand the section named after the environment name
| | ... | 4. Click on the following in the Connections pane	| Application Pools
| | ... | 5. Right-click the row with the name	| 98f31698-90a0-4ead-87e3-dac723fed2a6
| | ... | 6. Click	| Advanced Settings...
| | ... | 7. Click the field "Identity" under the section "Process Model"
| | ... | 8. Click the "..." button on the field
| | ... | 9. Set Custom Account	| Username: ${Username}	| Password: ${Password}	| Confirm password: ${Password}
| | ... | 10. Click	| OK
| | ... | 11. Click	| OK

| Login as Project Owner and Navigate to Configuration Option
| | [ARGUMENTS] 	| ${ProjectOwnerEmail}	| ${Password}	| ${WorkspaceName}
| | Run the following manual steps
| | ... | 1. Open a browser and log in to Relativity as	| ${ProjectOwnerEmail}	| ${Password}
| | ... | 2. Go to the Workspace	| ${WorkspaceName}
| | ... | 3. Go to the Tab		| Setup
| | ... | 4. Go to the Option		| Configuration

| Configure LDAP with the Following Values
| | Run the following manual steps:
| | ... | 1. Click			| Edit
| | ... | 2. Enter the LDAP Domain	| testing.corp
| | ... | 3. Enter the LDAP Username	| rellockdown
| | ... | 4. Enter the LDAP Password	| P@ssw0rd@1
| | ... | 5. Click			| Save

| Create Basic Method LDAP Mapping
| | [Documentation]	| Go to the Projects > Configuration tab and map LDAP fields to Method Custodian fields
| | Select Tab		| Projects
| | Select Sub-Tab	| Configuration
| | Click the Button	| LDAP Settings
| | Map the Fields	| Objectguid	| Unique ID
| | Map the Fields	| name		| First Name
| | Map the Fields	| sn		| Last Name
| | Map the Fields	| mail		| Email
| | Map the Fields	| countrycode	| Department
| | Click the Button	| Save


*** Settings ***
| Library	| ${KEYWORD_DIR}/ManualKeywords.py
| Library	| ${KEYWORD_DIR}/kWebDriver.py
| Resource	| ${KEYWORD_DIR}/Relativity/Shared/RelativityKeywords.txt
| Resource	| ${METHOD_KEYWORD_DIR}/NavigationKeywords.txt