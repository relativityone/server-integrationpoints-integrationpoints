
*** Settings ***
| Documentation 	| Verify that the Relativity Integration Points application can import into objects besides Custodians.
| Metadata			| Authors	| William Sehy
| Force Tags		| in-progress	| team.method
| Suite Setup		| Create Suite Setup Data
| Test Teardown 	| Run Keyword if Test Failed	| Capture Page Screenshot
| Suite Teardown	| Delete the Objects created in the Suite then Close All Browsers


*** Variables ***

| ${WorkspaceName}		| LDAP Sync
| ${IntegrationName}	| Questionnaires


*** Test Cases ***

| Questionnaire Objects can be created
| | [Documentation]	| Verify that Relativity Integration Points can be used to create Questionnaire objects.
| | ...				| [id] 13804f80-a89f-11e4-b5d4-b8ca3a83048f
| | Filter the following Grid on the following Column by the following Value	| gbox_questionnairesGrid	| Name	| Imported Questionnaire

| | Verify that the following Grid contains the following number of Rows	| gbox_questionnairesGrid	| 1


*** Keywords *** 

| Create Suite Setup Data
| | [Documentation]	| Create the Suite Preconditions
| | Setup connection to the relativity database
| | Open and Log in to Method
| | Setup connection to the Relativity Services API for Method	| ${WorkspaceName}

| | ${QuestionnaireExists}=	| Determine if the Following Questionnaire Exists in the current Workspace	| Imported Questionnaire
| | Run Keyword If 	| ${${QuestionnaireExists}}	| Delete the Following Questionnaire using API	| Imported Questionnaire

| | ${IntegrationPointExists}=	| Determine if the Following Integration Point Exists in the current Workspace	| ${IntegrationName}
| | Run Keyword If	| ${${IntegrationPointExists}}	| Delete the following Integration Point using API 	| ${IntegrationName}

| | @{Step1Fields}=	| Create List	| ${IntegrationName}	| Append	| LDAP	| Questionnaire	| No
| | @{Step2Fields}=	| Create List	| gameofholds.testing.corp/CN=Users,DC=gameofholds,DC=testing,DC=corp	| 
| | ... | (department=Questionnaire)	| FastBind	| testing\\rellockdown	| P@ssw0rd@1
| | @{Step3Mapping}=	| Create List	| Name [Object Identifier]	| givenname

| | Create Integration Point	| ${Step1Fields}	| ${Step2Fields}	| ${Step3Mapping}	| Name [Object Identifier]

| | Run Import Now on the Following Integration Point	| ${IntegrationName}

| | Go to the Method Tab	| Questionnaires
| | [Teardown]		| Drop connection to the relativity services api

| Delete the Objects created in the Suite then Close All Browsers
| | [Documentation]	| Delete the Suite test data of Integration Point and Custodians.
| | Setup connection to the Relativity Services API for Method	| ${WorkspaceName}

| | Delete the following Integration Point using API	| ${IntegrationName}

| | Delete the Following Questionnaire using API	| Imported Questionnaire

| | Drop connection to the relativity services api
| | Close All Browsers


*** Settings ***
| Library	| Collections
| Library	| ${KEYWORD_DIR}/kWebDriver.py
| Resource	| ${KEYWORD_DIR}/Method/Method_Keywords_API.txt
| Resource	| ${METHOD_KEYWORD_DIR}/GridKeywords.txt
| Resource	| ${METHOD_KEYWORD_DIR}/MiscMethodKeywords.txt
| Resource	| ${METHOD_KEYWORD_DIR}/NavigationKeywords.txt
| Resource	| ${METHOD_KEYWORD_DIR}/QuestionnaireKeywords.txt
| Resource	| ${LDAP_KEYWORD_DIR}/DatabaseKeywords.txt
| Resource	| ${LDAP_KEYWORD_DIR}/IntegrationPointKeywords.txt