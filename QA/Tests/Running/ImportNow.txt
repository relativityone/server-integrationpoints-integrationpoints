
*** Settings ***
| Documentation 	| Verify that the Import Now button is placed and functions correctly.
| Metadata			| Authors	| Daniel Oliver	| William Sehy
| Force Tags		| in-progress	| team.method
| Suite Setup		| Open the Browser and Create the Integration Points needed by the Suite
#| Test Setup		| NONE
| Test Teardown 	| Capture screenshot if test fails
| Suite Teardown	| Delete the Integration Points created in this Suite then Close All Browsers


*** Variables ***

| ${WorkspaceName}		| LDAP Sync
| ${IntegrationPoint1}	| Enabled Integration Point
| ${IntegrationPoint2}	| Disabled Integration Point


*** Test Cases ***

| Import Now button UI
| | [Documentation] | Verify that both the IMPORT column and Import Now buttons are present
| | ...				| [id] 16edffcf-ad51-11e4-8b0c-90b11c6c5ae4
| | [Tags]			| manual	| visual
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Go to the Tab	| Integration Points
| | ... | 2. View Integration Point	| ${IntegrationPoint1}
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that the IMPORT column is on the right of the screen
| | ... | 2. Verify that the Import Now button is in the IMPORT column


| Import Now is active when there is no Schedule
| | [Documentation] | Verify that the Import Now button is active when Enable Scheduler is set to No
| | ...				| [id] 7e0125a1-ad54-11e4-b89d-90b11c6c5ae4
| | [Tags]			| manual	| automateable
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. ${IntegrationPoint2} has the Enable Scheduler set to No
| | ... |
| | ... | Steps:
| | ... | 1. Go to the Tab	| Integration Points
| | ... | 2. View Integration Point	| ${IntegrationPoint2}
| | ... | 
| | ... | Expected Results:
| | ... | Verify that the Import Now button is active


| Import Now is active when there is a Schedule
| | [Documentation] | Verify that the Import Now button is active when Enable Scheduler is set to Yes 
| | ...				| [id] 7fadc430-ad54-11e4-be8a-90b11c6c5ae4
| | [Tags]			| manual	| automateable
| | Run the following manual steps:
| | ... | Pre-conditions:
| | ... | 1. ${IntegrationPoint3} has the Enable Scheduler set to Yes
| | ... | 
| | ... | Steps:
| | ... | 1. Go to the Tab	| Integration Points
| | ... | 2. View Integration Point	| ${IntegrationPoint1}
| | ... |
| | ... | Expected Results:
| | ... | Verify that the Import Now button is active


| Import Now Dialog UI format is correct
| | [Documentation] | Verify that the Import Now dialogs UI is correct.
| | ...				| [id] 8988c740-ad57-11e4-969f-90b11c6c5ae4
| | [Tags]			| manual	| automateable
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Go to the Tab	| Integration Points
| | ... | 2. View Integration Point	| ${IntegrationPoint3}
| | ... | 3. Click	| Import Now
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that the heading is: Import Now
| | ... | 2. Verify that the text is: Are you sure you want to import data now?
| | ... | 3. Verify that the OK and Cancel buttons are present in the bottom right corner


| Clicking Cancel from the Dialog does not create a new Import job
| | [Documentation] | Verify that clicking Cancel from the Dialog does not create a new Import job.
| | ...				| [id] 8b5dae51-ad57-11e4-bcb9-90b11c6c5ae4
| | [Tags]			| manual	| automateable
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Go to the Tab	| Integration Points
| | ... | 2. View Integration Point	| ${IntegrationPoint3}
| | ... | 3. Click	| Import Now
| | ... | 4. Click	| Cancel
| | ... | 5. View the eddsdbo.ScheduleAgentQueue
| | ... | 
| | ... | Expected Results:
| | ... | Verify that no SyncManager (TaskType column) has been created


| Clicking OK from the Dialog creates a new Job
| | [Documentation] | Verify that clicking OK from the Dialog creates a new Job.
| | ...				| [id] 873c6d9e-ad54-11e4-9396-90b11c6c5ae4
| | [Tags]			| manual	| automateable?
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Go to the Tab	| Integration Points
| | ... | 2. View Integration Point	| ${IntegrationPoint3}
| | ... | 3. Click	| Import Now
| | ... | 4. Click	| OK
| | ... | 5. View the eddsdbo.ScheduleAgentQueue
| | ... | 
| | ... | Expected Results:
| | ... | Verify that a SyncManager (TaskType column) has been created


| The Importing Now message is correct
| | [Documentation] | Verify that using the Import Now button shows a message with the text "Data will now be imported from the source provider.".
| | [Tags]			| manual	| automateable
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Go to the Tab	| Integration Points
| | ... | 2. View Integration Point	| ${IntegrationPoint3}
| | ... | 3. Click	| Import Now
| | ... | 4. Click	| OK
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that a green message appears between the Layout dropdown's row and the General card
| | ... | 2. Verify that the message has the following text	| "Data will now be imported from the source provider."


*** Keywords ***

| Open the Browser and Create the Integration Points needed by the Suite
| | [Documentation]	| Opens the browser and then creates both of the Integration Points used in this suite.
| | ...				| Run as the Suite Setup.
| | Setup connection to the relativity database
| | Open and Log in to Method
| | Setup connection to the Relativity Services API for Method	| ${WorkspaceName}

#------------------------------------------------------------------------------------------------------------------------

| | ${IntegrationPointExists}=	| Determine if the Following Integration Point Exists in the current Workspace	| ${IntegrationPoint1}
| | Run Keyword If	| ${${IntegrationPointExists}}	| Delete the following Integration Point using API 	| ${IntegrationPoint1}

| | ${IntegrationPointExists}=	| Determine if the Following Integration Point Exists in the current Workspace	| ${IntegrationPoint2}
| | Run Keyword If	| ${${IntegrationPointExists}}	| Delete the following Integration Point using API 	| ${IntegrationPoint2}

#------------------------------------------------------------------------------------------------------------------------

| | @{Step1Fields}=	| Create List	| ${IntegrationPoint1}	| Append		| LDAP	| Custodian	| 
| | ...	| Yes		| Daily	| NULL	| NULL	| 02/25/2015	| 02/26/2025	| 11:25

| | @{Step2Fields}=	| Create List	| gameofholds.testing.corp/CN=Users,DC=gameofholds,DC=testing,DC=corp	| 
| | ... | (objectClass=*)	| FastBind	| testing\\rellockdown	| P@ssw0rd@1

| | @{Step3Mapping}=	| Create List	|
| | ... | First Name	| givenName		| 
| | ... | Last Name		| sn			| 
| | ... | Email			| mail			| 
| | ... | Department	| countrycode	| 
| | ... | UniqueID		| objectguid

| | Create Integration Point | ${Step1Fields} | ${Step2Fields} | ${Step3Mapping} | UniqueID

#------------------------------------------------------------------------------------------------------------------------

| | @{Step1Fields}=	| Create List	| ${IntegrationPoint1}	| Append	| LDAP	| Custodian	| No

| | Create Integration Point | ${Step1Fields} | ${Step2Fields} | ${Step3Mapping} | UniqueID
| | [Teardown] | Drop connection to the relativity services api

| Delete the Integration Points created in this Suite then Close All Browsers
| | [Documentation]	| Delete the Integration Points that were created in the Suite and then closes any open browsers.
| | ...				| Run as the Suite Teardown.
| | Setup connection to the Relativity Services API for Method	| ${WorkspaceName}

| | Delete the following Integration Point using API 	| ${IntegrationPoint1}

| | Delete the following Integration Point using API 	| ${IntegrationPoint2}

| | Close All Browsers
| | Drop connection to the relativity services api


*** Settings ***
| Library	| ${KEYWORD_DIR}/ManualKeywords.py
| Library	| ${KEYWORD_DIR}/kWebDriver.py
| Resource	| ${METHOD_KEYWORD_DIR}/MiscMethodKeywords.txt
| Resource	| ${METHOD_KEYWORD_DIR}/NavigationKeywords.txt
| Resource	| C:/SourceCode/LDAPSync/QA/Keywords/DatabaseKeywords.txt
| Resource	| C:/SourceCode/LDAPSync/QA/Keywords/IntegrationPointKeywords.txt