*** Settings ***
| Documentation 	| Verify that the Map Fields step of Integration Points allows RDO fields to be selected
| Metadata		    | Authors	| Daniel Oliver
| Force Tags		| in-progress | team.method
| Suite Setup		| Open and Log in to Method
| Test Setup        | Go to Step 3 of the Create Integration Point Process
| Test Teardown 	| Capture screenshot if test fails
| Suite Teardown	| Close all browsers

*** Variables ***

| ${WorkspaceName}	     | Relativity Legal Hold
| ${ValidConnectionPath} | 
| ${OverlayIdentifierID} | 
| ${Workspace Field List}   | workspace-fields
| ${Selected Workspace List}    | selected-workspace-fields
| ${SelectedAttributeListID}    | selected-source-fields
| ${SourceAttributeListID}      | source-attributes
| ${Add All Workspace Fields Icon}   | add-all-workspace-fields
| ${Add Workspace Field Icon}       | add-workspace-field
| ${RemoveWorkspaceFieldIcon}    | remove-workspace-field
| ${Remove All Workspace Fields Icon} | remove-all-workspace-fields
| ${MoveWorkspaceFieldUpIcon}        | workspace-field-up
| ${MoveWorkspaceFieldDownIcon}      | workspace-field-down
| ${AddAllSourceFieldsIcon}   | add-all-source-fields
| ${AddSourceFieldIcon}       | add-workspace-field
| ${RemoveSourceFieldIcon}    | remove-source-field
| ${RemoveAllSourceFieldsIcon} | remove-all-source-fields
| ${Field1}                    | Communication
| ${Field2}                    | Batch Set

*** Test Cases ***

| An Individual Field can be selected and put into the Selected list
| | [Documentation] | Verify that one field can be moved from the Workspace list to the Selected Workspace list
| | [Tags] | automated
| | Click Workspace Field  | ${Field1}
| | Move fields to the Selected Workspace list

| | Verify that the Selected Workspace fields are in the following order | ${Field1}

| Fields are removed from the Workspace list when they are put into the Selected Workspace list
| | [Documentation] | Verify that moving a field from the Workspace list to the Selected list, removes the field from the Workspace list
| | [Tags] | automated
| | Click Workspace Field  | ${Field1}
| | Move fields to the Selected Workspace list

| | Verify that the following field is not in the following list  | ${Field1} | ${Workspace Field List} 

| Multiple Individual fields can be selected and moved individually
| | [Documentation] | Verify that one field can be moved to the Selected Workspace list, and the process can then be repeated for another field with the newly moved field placed at the end of the list.
| | [Tags] | automated
| | Click Workspace Field  | ${Field1}
| | Move fields to the Selected Workspace list
| | Click Workspace Field  | ${Field2}
| | Move fields to the Selected Workspace list

| | Verify that the Selected Workspace fields are in the following order | ${Field1} | ${Field2}

| Mutliple Fields can be selected and moved with one click 
| | [Documentation] | Verify that mutliple Fields can be selected, and then they are all moved by clicking the Move to Selected list icon. The sort order of the newly moved fields is then alphabetical (assuming they were just in alphabetical order).
| | [Tags] | automated
| | Click Workspace Field  | ${Field2}
| | Click Workspace Field  | ${Field1}
| | Move fields to the Selected Workspace list

| | Verify that the Selected Workspace fields are in the following order | ${Field2} | ${Field1}

| Moving a field back to Workspace Fields adds it to the bottom of the list
| | [Documentation] | Verify that moving a field back to the Workspace field list places the field at the bottom of the list
| | [Tags] | untested | manual | automateable
| | Click Workspace Field  | ${Field1}
| | Move fields to the Selected Workspace list
| | Click Selected Workspace Field 
| | Move fields to the Workspace list

| | Run the following manual steps:
| | ... | Expected Results:
| | ... | 1. Verify that ${Field1} has is at the end of the Workspace list

| Fields are removed from the Selected Workspace list when they are put into the Workspace list
| | [Documentation] | Verify that moving a field from the Selected Workspace list to the Workspace list, removes the field from the Selected Workspace list
| | [Tags] | untested
| | Click Workspace Field  | ${Field1}
| | Move fields to the Selected Workspace list
| | Click Selected Workspace Field 
| | Move fields to the Workspace list

| | Verify that the following field is not in the following list  | ${Field1} | ${Selected Workspace List} 

| Clicking the Move All Workspace icon moves all fields from the Workspace Fields to Selected Fields 
| | [Documentation] | Verify that clicking the Move All Workspace icon moves all fields from the Workspace Fields to Selected Fields 
| | [Tags] | untested | manual
| | Click | ${Add All Workspace Fields Icon}

| | Run the following manual steps:
| | ... | Expected Results:
| | ... | 1. Verify that the Workspace list is empty
| | ... | 2. Verify that the Select Workspace list contains every field

| Clicking the Move All Selected icon moves all fields from the Selected Fields list to the 
| | [Documentation] | Verify that clicking the Move All Workspace icon moves all fields from the Selected Fields list to the Workspace Field list
| | [Tags] | untested | manual
| | Click | ${Add All Workspace Fields Icon}
| | Click | ${Remove All Workspace Fields Icon}

| | Run the following manual steps:
| | ... | Expected Results:
| | ... | 1. Verify that the Select Workspace list is empty
| | ... | 2. Verify that the Workspace list contains every field

| Multiple Fields can be selected be clicking and dragging
| | [Documentation] | Verify that multiple fields can be seleted by clicking one field and dragging.
| | [Tags] | untested | manual
| | Run the following manual steps:
| | ... | 1. Click one field in the Workspace Fields list.
| | ... | 2. Drag over several other fields.
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that each field that was dragged over is selected

| Mutliple Fields can be Control Clicked
| | [Documentation] | Verify that multiple fields can be seleted by control clicking
| | [Tags] | untested | manual
| | Run the following manual steps:
| | ... | 1. Click one field in the Workspace Fields list.
| | ... | 2. Control click several other fields.
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that each field that was clicked  is selected

| Selected field rows are blue
| | [Documentation] | Verify that clicking a field turns its row blue
| | [Tags] | untested | manual
| | Run the following manual steps:
| | ... | 1. Click one field in the Workspace Fields list.
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that the row color for the selected field is blue

| Selected field rows on inactive lists are grey
| | [Documentation] | Verify that a selected row turns grey when clicking anywhere else on the screen
| | [Tags] | untested | manual
| | Run the following manual steps:
| | ... | 1. Click one field in the Workspace Fields list.
| | ... | 2. Click any whitespace
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that the row color for the selected field is grey

| Doubling clinking an Individual Field moves it to other list
| | [Documentation] | Verify that a selected row turns grey when clicking anywhere else on the screen
| | [Tags] | untested | manual
| | Run the following manual steps:
| | ... | 1. Double click a field in the Workspace Fields list.
| | ... | 
| | ... | Expected Results:
| | ... | 1. Verify that the field is now in the Selected Workspace Fields list.

*** Keywords *** 

| Verify that the following field is not in the following list
| | [Documentation] | A keyword that verifies that the specified field is not present in the specified list.
| | [Arguments] | ${FieldName} | ${ListName}
| | Element should not be visible  |  xpath=//select[@id='${ListName}']/option[text()='${FieldName}']

| Move fields to the Selected Workspace list
| | [Documentation] | A keyword that clicks the "Move to Selected list" icon
| | Click | ${Add Workspace Field Icon}

| Move fields to the Workspace list
| | [Documentation] | A keyword that clicks the "Move to Workspace list" icon
| | Click | ${RemoveWorkspaceFieldIcon}

| Verify that the Selected Workspace fields are in the following order
| | [Documentation] | A keyword that verifies the fields in the Selected Workspace list are in the desired order.
| | [Arguments] | @{ExpectedFields}
| | Wait until keyword succeeds | 20s | 2s | Element Should be Visible	| xpath=//select[@id='selected-workspace-fields']	| The Selected Fields list box was not visible.
| | @{ActualFields}=	| Get Element Text	| xpath=//select[@id='selected-workspace-fields']/option | False 
| | Lists should be Equal	| ${ActualFields}	| ${ExpectedFields}

| Click Workspace Field 
| | [Documentation] | A keyword that clicks an item from the (unselected) Workspace Field list. Multiple calls of select can be used with a single Click of Move.
| | [Arguments] | ${Field}
| | Wait until keyword succeeds | 20s | 2s | Element should be visible  | xpath=//select[@id='workspace-fields'] | The Workspace Fields list box was not visible.
| | Click | xpath=//select[@id='workspace-fields']/option[text()='${Field}']

| Click Selected Workspace Field 
| | [Documentation] | A keyword that clicks an item from the Selected Workspace Field list. Multiple calls of select can be used with a single Click of Move.
| | [Arguments] | ${Field}
| | Wait until keyword succeeds | 20s | 2s | Element should be visible  | xpath=//select[@id='slected-workspace-fields'] | The Selected Workspace Fields list box was not visible.
| | Click | xpath=//select[@id='selected-workspace-fields']/option[text()='${Field}']

| Go to Step 3 of the Create Integration Point Process
| | Open Create Integration Point
| | Fill out the Following Fields of the Integration Point Step 1 form | Moving Workspace Field tests | Append/Overlay | LDAP | Custodian | no
#| | Fill out the Following Fields of the Integration Point Step 2 form | ${ValidConnectionPath}
| | Click | next
| | Wait until keyword succeeds | 20s | 2s | Click | next

*** Settings ***
| Library   | Collections
| Library	| ${KEYWORD_DIR}/ManualKeywords.py
| Library	| ${KEYWORD_DIR}/kWebDriver.py
| Resource	| ${METHOD_KEYWORD_DIR}/MiscMethodKeywords.txt
| Resource	| ${METHOD_KEYWORD_DIR}/NavigationKeywords.txt
| Resource  | C:/SourceCode/LDAPSync/QA/Keywords/IntegrationPointKeywords.txt
