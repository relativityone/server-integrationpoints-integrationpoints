*** Settings ***
| Documentation | Verify that the correct job status is displayed on the RIP View page for Integration Points that have been imported
| Metadata      | Authors	| Daniel Oliver	
| Force Tags		| in-progress | team.game_of_holds	| feature.integration_points
| Suite Setup		| Create Suite Setup Data
| Test Teardown 	| Run Keyword if Test Failed	| Capture Page Screenshot
| Suite Teardown	| Delete the Objects created in the Suite then Close All Browsers


#------------------- this functionality has not been implemented ------------------------

*** Variables ***

| ${WorkspaceName}	          | LDAP Sync
| ${IntegrationName1}         | Job Status Testing
| ${IntegrationName2}         | Job Status with Errors
| ${Department1}              | Status Testing Pass
| ${Department2}              | Status Testing with Errors

*** Test Cases ***

| Status is blank when the Integration Point has not been run
| | [Documentation] | Verify that Integration Points that have not been imported have no value in the Status field
| | ...				| [id] 582781c0-c358-11e4-a238-90b11c6c5ae4
| | [Tags] | automateable
| | View Integration Point | ${IntegrationName1}

| | Verify that the Job Status has the Following value  | ${EMPTY}

| Status is Pending when the Integration Point is about to be run
| | [Documentation] | Verify that Integration Points that are about to be imported (i.e. have not been picked up by an agent) have a Status of Pending
| | [Tags] | manual
| | View Integration Point | ${IntegrationName1}

| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Run the Import for this Integration Point.
| | ... | 2. Refresh the screen.
| | ... |
| | Expected Results:
| | ... | 1. Verify that the Job Status has the Following value  | Pending

| Status is Processing when the Integration Point is currently running
| | [Documentation] | Verify that Integration Points that are currently importing (i.e. have been picked up by an agent) have a Status of Processing 
| | [Tags] | manual
| | View Integration Point | ${IntegrationName1}

| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Run the Import for this Integration Point.
| | ... | 2. Wait for the job to be picked up by the Agent
| | ... | 3. Refresh the screen.
| | ... |
| | Expected Results:
| | ... | 1. Verify that the Job Status has the Following value  | Pending

| Status is Complete when the Integration Point has run without error
| | [Documentation] | Verify that Integration Points that have successfully completed without error have a Status of Complete
| | [Tags] | manual
| | View Integration Point | ${IntegrationName1}

| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Run the Import for this Integration Point.
| | ... | 2. Wait for the job to complete
| | ... | 3. Refresh the screen.
| | ... |
| | Expected Results:
| | ... | 1. Verify that the Job Status has the Following value  | Complete

| Status is Complete with Errors when the Integration Point has run with errors
| | [Documentation] | Verify that Integration Points that have successfully completed with some errors have a Status of Complete with errors
| | [Tags] | automateable
| | Run Import Now on the Following Integration Point | ${IntegrationName2}
| | View Integration Point | ${IntegrationName2}

| | Verify that the Job Status has the Following value  | Complete with errors

| Status is Error - job failed when the Integration Point has failed
| | [Documentation] | Verify that Integration Points that have failed have a Status of Error - job failed 
| | [Tags] | manual
| | Run the following manual steps:
| | ... | Steps:
| | ... | 1. Setup an Injection Point to fail an Integration Point
| | ... | 2. Run an Integration Point Import
| | ... | 3. Refresh the screen
| | ... |
| | Expected Results
| | ... | 1. Verify that the Job Status has the Following value  | Error - job failed 

*** Keywords *** 

| Verify that the Job Status has the Following value
| | [Documentation]	| A keyword that 
| | [Arguments] | ${JobStatus}
| | Element Should Be Visible | xpath=//*[@id='jobStatus'] | The Job Status field was not found.
| | ${ActualText}=	| Get Text	| xpath=//*[@id='jobStatus']/following-sibling::td[@class='dynamicViewFieldValue']
| | Run Keyword Unless	| '${ActualText}' == '${JobStatus}'	| Fail	| The field values was incorrect. It should have been "${JobStatus}" but it was actually "${ActualText}".
| | Element Should Be Visible	| xpath=//*[@id='jobStatus']/following-sibling::td[text()='${JobStatus}']

| Create Suite Setup Data
| | [Documentation]	| Create the Suite Preconditions
| | Setup connection to the relativity database
| | Open and Log in to Legal Hold
| | Setup connection to the Relativity Services API for Legal Hold	| ${WorkspaceName}

| | @{Step1Fields}=  | Create List | ${IntegrationName1} | Junk Data |
| | ... | LDAP | Custodian | no
| | @{Step2Fields}=  | Create List | gameofholds.testing.corp/CN=Users,DC=gameofholds,DC=testing,DC=corp | 
| | ... | (department=${Department1}) | FastBind | testing\\rellockdown | P@ssw0rd@1
| | @{Step3Mapping}=	| Create List	|
| | ... | Email			| mail			| 
| | ... | Department	| department	| 
| | ... | First Name	| givenname		| 
| | ... | Last Name		| sn			| 
| | ... | UniqueID		| objectguid

| | Create LDAP Integration Point | ${Step1Fields} | ${Step2Fields} | ${Step3Mapping} | Append/Overlay | Email

| | @{Step1Fields}=  | Create List | ${IntegrationName2} | Junk Data |
| | ... | LDAP | Custodian | No
| | @{Step2Fields}=  | Create List | gameofholds.testing.corp/CN=Users,DC=gameofholds,DC=testing,DC=corp | 
| | ... | (department=${Department2}) | FastBind | testing\\rellockdown | P@ssw0rd@1
| | @{Step3Mapping}=	| Create List	|
| | ... | Email			| mail			| 
| | ... | Department	| department	| 
| | ... | First Name	| givenname		| 
| | ... | Last Name		| sn			| 
| | ... | UniqueID		| objectguid

| | Create LDAP Integration Point | ${Step1Fields} | ${Step2Fields} | ${Step3Mapping} | Append/Overlay | Email

| | @{Step1Fields}=  | Create List | ${IntegrationName3} | Junk Data |
| | ... | LDAP | Custodian | No
| | @{Step2Fields}=  | Create List | gameofholds.testing.corp/CN=Users,DC=gameofholds,DC=testing,DC=corp | 
| | ... | (department=${Department3}) | FastBind | testing\\rellockdown | P@ssw0rd@1
| | @{Step3Mapping}=	| Create List	|
| | ... | Email			| mail			| 
| | ... | Department	| department	| 
| | ... | First Name	| givenname		| 
| | ... | Last Name		| sn			| 
| | ... | UniqueID		| objectguid

| | Create LDAP Integration Point | ${Step1Fields} | ${Step2Fields} | ${Step3Mapping} | Append/Overlay | Email

| | [Teardown] | Drop connection to the relativity services api

| Delete the Objects created in the Suite then Close All Browsers
| | [Documentation]	| Delete the Suite test data of Integration Point and Custodians.
| | Setup connection to the Relativity Services API for Legal Hold	| ${WorkspaceName}

| | Delete the following Integration Point using API | ${IntegrationName1}
| | Delete the following Integration Point using API | ${IntegrationName2}
| | Delete the following Integration Point using API | ${IntegrationName3}

| | Delete the Custodians in the Following Department using API	| ${Department1}
| | Delete the Custodians in the Following Department using API	| ${Department2}

| | Drop connection to the relativity services api
| | Close All Browsers

*** Settings ***
| Library	| Collections
| Library	| ${KEYWORD_DIR}/kWebDriver.py
| Resource	| ${KEYWORD_DIR}/LegalHold/Legal_Hold_Keywords_API.txt
| Resource	| ${LEGAL_HOLD_KEYWORD_DIR}/GridKeywords.txt
| Resource	| ${LEGAL_HOLD_KEYWORD_DIR}/MiscLegalHoldKeywords.txt
| Resource	| ${LEGAL_HOLD_KEYWORD_DIR}/NavigationKeywords.txt
| Resource	| ${LDAP_KEYWORD_DIR}/IntegrationPointKeywords.txt

