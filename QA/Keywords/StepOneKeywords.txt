
*** Settings ***
| Documentation	| This suite of keywords deals with Step 1 of the Integration Point object's Wizard and its associated actions.


*** Keywords ***

| Fill out the Following Fields of the Integration Point Step 1 form
| | [Documentation]	| This keyword fills out the Integration Point Step 1 fields.
| | ... 			| The value of ${Frequency} should be Select.../Daily/Weekly/Monthly.
| | ... 			| The acceptable values ${SendOn} vary by the selected ${Frequency}.
| | ... 			| - When ${Frequency} is 'Weekly' then ${SendOn} should be a semicolon seperated list of the desired days of the week (Note: Each day of the week should begin with a capital letter).
| | ... 			| -- Alternatively, you can clear the checkboxes by passing in the value 'Clear' for ${SendOn}
| | ... 			| - When ${Frequency} is 'Monthly' then ${SendOn} should be one of two strings: 
| | ...				| -- 'The <X> <Y> of the month' where X is First, Second, Third, Fourth, or Last, and Y is any day Monday-Sunday or just 'day'.
| | ...				| -- 'Day <X> of the month' where X is any value from 1-31.
| | ...				| The value of ${ScheduledTime} should be expressed HH:MM AM/PM.
| | [ARGUMENTS]		| ${IntegrationName}=NULL	| ${SourceProvider}=NULL	| ${DestinationRDO}=NULL	| ${EnableScheduler}=NULL	| ${Frequency}=NULL		| 
| | ...				| ${Reoccur}=NULL			| ${SendOn}=NULL			| ${StartDate}=NULL			| ${EndDate}=NULL			| ${ScheduledTime}=NULL
| | Wait Until Page Contains Element	| id=name	| 10s	| The page was not on Step 1 of the Integration Point form.
| | Run Keyword Unless	| "${IntegrationName}" == "NULL"	| Input Text	| id=name	| ${IntegrationName}
| | Run Keyword Unless	| "${SourceProvider}" == "NULL"		| Select from Select2 Dropdown	| s2id_sourceProvider	| ${SourceProvider}
| | Run Keyword Unless	| "${DestinationRDO}" == "NULL"		| Select from Select2 Dropdown	| s2id_destinationRdo	| ${DestinationRDO}

| | Run Keyword If		| "${EnableScheduler.lower()}" == "yes"		| Select Radio Button	| enable	| true	| 
| | ... | ELSE IF		| "${EnableScheduler.lower()}" == "no"		| Select Radio Button	| enable	| false	| 
| | ... | ELSE IF		| "${EnableScheduler.lower()}" != "null"	| Fail	| The variable "EnableScheduler" expected "Yes", "No", or "NULL", but got "${EnableScheduler}".

| | ${SchedulerEnabled}=	| Get Selected Radio Button Value	| enable
| | @{SchedulerValues}=	| Create List	| ${Frequency}	| ${Reoccur}	| ${SendOn}	| ${StartDate}	| ${EndDate}	| ${ScheduledTime}
| | @{NullValues}=		| Create List	| NULL			| NULL			| NULL		| NULL			| NULL			| NULL
| | Run Keyword Unless	| ${${SchedulerEnabled}}	| Lists Should Be Equal	| ${SchedulerValues}	| ${NullValues}	| The Scheduler fields cannot be changed while Enable Scheduler is set to No.

| | Run Keyword Unless	| "${Frequency}" == "NULL"		| Select from Select2 Dropdown	| s2id_frequency	| ${Frequency}

| | ${FrequencyValue}=	| Determine the currently selected value of a select2 Dropdown	| s2id_frequency
| | @{ConditionalSchedulerValues}=	| Create List	| ${Reoccur}	| ${SendOn}
| | @{NullValues}=					| Create List	| NULL			| NULL
| | Run Keyword Unless	| ("${FrequencyValue}" == "Monthly") or ("${FrequencyValue}" == "Weekly")	| Lists Should Be Equal	| ${ConditionalSchedulerValues}	| ${NullValues}	| The Reoccur and Send On fields cannot be changed while Frequency is set to "${FrequencyValue}".

| | Run Keyword Unless	| "${Reoccur}" == "NULL"	| Input Text	| id=reoccur	| ${Reoccur}

| | Run Keyword If	| ("${FrequencyValue}" == "Weekly") and ("${SendOn}" != "NULL")		| StepOneKeywords.Fill out the Send On field for a Weekly Frequency	| ${SendOn}	| 
| | ... | ELSE IF	| ("${FrequencyValue}" == "Monthly") and ("${SendOn}" != "NULL")	| StepOneKeywords.Fill out the Send On field for a Monthly Frequency	| ${SendOn}

| | Run Keyword Unless	| "${ScheduledTime}" == "NULL"	| Fill Out the Scheduled Time field	| ${ScheduledTime}	| # Out of order due to date picker issues with the End Date. This does not work when date picker overlaps dropdown.

| | Run Keyword Unless	| "${StartDate}" == "NULL"	| Input Text	| id=scheduleRulesStartDate	| ${StartDate}

| | Run Keyword Unless	| "${EndDate}" == "NULL"	| Input Text	| id=scheduleRulesEndDate	| ${EndDate}

| Fill out the Send On field for a Weekly Frequency
| | [Documentation]	| Selects the given checkboxes of the Weekly Send On field's checkboxes.
| | ... 			| [Tags] private
| | [ARGUMENTS] 	| ${SendOn}
| | ${SendOn}=	| Replace String	| ${SendOn}	| ${SPACE}	| ${EMPTY}
| | StepOneKeywords.Clear the Weekly Send On Field
| | Run Keyword Unless	| '${SendOn.lower()}' == 'clear'	| StepOneKeywords.Populate the Weekly Send On Field	| ${SendOn}

| Clear the Weekly Send On Field
| | [Documentation]	| Unselects all of the Weekly Send On field's checkboxes.
| | ... 			| [Tags] private
| | Click	| id=name	| # The cursor can get stuck on the Reoccur field. This just clicks out of the field and has no other effects.
| | @{DaysOfTheWeek}=	| Create List	| Monday	| Tuesday	| Wednesday	| Thursday	| Friday	| Saturday	| Sunday
| | :FOR	| ${Locator}	| IN RANGE	| 7	| # Run for values 0 to 6
| | | Unselect Checkbox	| xpath=//input[@type='checkbox' and @value='${DaysOfTheWeek[${Locator}]}']

| Populate the Weekly Send On Field
| | [Documentation]	| This keywords splits up the given string, which should be a semicolon seperated list of days. 
| | ... 			| It then selects the Send On field checkboxes for the given days.
| | ... 			| [Tags] private
| | [ARGUMENTS] 	| ${SendOn}
| | @{Days}=	| Split String	| ${SendOn}	| ;	| 6
| | :FOR	| ${Day}	| IN	| @{Days}
| | | Element Should Be Visible	| xpath=//input[@type='checkbox' and @value='${Day}']	| Could not find the checkbox for "${Day}". 
| | | Select Checkbox	| xpath=//input[@type='checkbox' and @value='${Day}']

| Fill out the Send On field for a Monthly Frequency
| | [Documentation]	| Fills out the Send On fields present when the Frequency is set to Monthly. 
| | ... 			| [Tags] private
| | [ARGUMENTS] 	| ${SendOn}
| | ${FirstWord}=	| Fetch from Left	| ${SendOn}	| ${Space}
| | Run Keyword If	| '${FirstWord.lower()}' == 'the'	| StepOneKeywords.Select the radio button for The X X of the month	| ${SendOn}
| | ... | ELSE IF	| '${FirstWord.lower()}' == 'day'	| StepOneKeywords.Select the day X of the month radio button		| ${SendOn}
| | ... | ELSE		| Fail	| The Send On field could not be filled out. The value "${SendOn}" was not valid.

| Select the day X of the month radio button
| | [Documentation]	| Selects the values for the Day X of the month option. This includes both setting the dropdown value and the radio button.
| | ... 			| [Tags] private
| | [ARGUMENTS] 	| ${SendOn}
| | ${DayValue}=	| Fetch from Left	| ${SendOn}	| ${Space}of the month
| | ${DayValue}=	| Fetch from Right	| ${DayValue}	| Day${Space}
| | Select from select2 Dropdown	| id=s2id_day-select	| ${DayValue}	| # The Send On dropdown
| | Select Radio Button	| monthly	| 2

| Fill Out the Scheduled Time field
| | [Documentation]	| Enters the Hour:Minute value and selects the AM/PM value.
| | ... 			| [Tags] private
| | [ARGUMENTS] 	| ${ScheduledTimeValue}
| | ${AMPMValue}=		| Fetch from Right	| ${ScheduledTimeValue}	| ${Space}
| | ${HourMinuteValue}=	| Fetch from Left	| ${ScheduledTimeValue}	| ${Space}
| | Input Text	| id=scheduledTime	| ${HourMinuteValue}
| | Select From Select2 Dropdown	| s2id_timeFormat	| ${AMPMValue.upper()}

| Select the radio button for The X X of the month
| | [Documentation]	| Selects the values for the "The X X of the month." option. This includes setting both the dropdown values and the radio button.
| | ... 			| [Tags] private
| | [ARGUMENTS] 	| ${SendOn}
| | ${BothValues}=	| Fetch from Left	| ${SendOn}	| ${Space}of the month
| | ${BothValues}=	| Fetch from Right	| ${BothValues}	| The${Space}
| | ${Occurance}	| ${Day}=	| Split String	| ${BothValues}	| ${Space}
| | Select from select2 Dropdown	| id=s2id_dayType		| ${Occurance}
| | Select from select2 Dropdown	| id=s2id_dayOfMonth	| ${Day}
| | Select Radio Button	| monthly	| 1


*** Settings ***
| Library	| String
| Library	| Collections
| Library 	| ${KEYWORD_DIR}/kWebDriver.py
| Resource	| ${LEGAL_HOLD_KEYWORD_DIR}/MiscLegalHoldKeywords.txt
| Resource	| ${LDAP_KEYWORD_DIR}/DatabaseKeywords.txt