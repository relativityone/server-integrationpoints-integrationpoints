!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.utils"],e):e(jQuery)}(function(M){"use strict";M.jgrid=M.jgrid||{},M.extend(M.jgrid,{formatCell:function(e,t,r,l,o,a){return void 0!==l.formatter?(t={rowId:"",colModel:l,gid:o.p.id,pos:t,styleUI:"",isExported:!0,exporttype:a},M.jgrid.isFunction(l.formatter)?l.formatter.call(o,e,t,r):M.fmatter?M.fn.fmatter.call(o,l.formatter,e,t,r):e):e},formatCellCsv:function(t,e){t=null==t?"":String(t);try{t=M.jgrid.stripHtml(t.replace(e._regexsep,e.separatorReplace).replace(/\r\n/g,e.replaceNewLine).replace(/\n/g,e.replaceNewLine))}catch(e){t=""}return t=-1!==(t=e.escquote?t.replace(e._regexquot,e.escquote+e.quote):t).indexOf(e.separator)&&-1!==t.indexOf(e.qoute)?t:e.quote+t+e.quote},excelCellPos:function(e){for(var t="A".charCodeAt(0),r="Z".charCodeAt(0)-t+1,l="";0<=e;)l=String.fromCharCode(e%r+t)+l,e=Math.floor(e/r)-1;return l},makeNode:function(e,t,r){var l=e.createElement(t);return r&&(r.attr&&M(l).attr(r.attr),r.children&&M.each(r.children,function(e,t){l.appendChild(t)}),r.hasOwnProperty("text"))&&l.appendChild(e.createTextNode(r.text)),l},xmlToZip:function(o,e){var a,d,n,i,p,s=this,m=new XMLSerializer,f=-1===m.serializeToString(M.parseXML(M.jgrid.excelStrings["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r"),u=[];M.each(e,function(e,t){if(M.isPlainObject(t))p=o.folder(e),s.xmlToZip(p,t);else{if(f){for(a=t.childNodes[0],d=a.attributes.length-1;0<=d;d--){var r=a.attributes[d].nodeName,l=a.attributes[d].nodeValue;-1!==r.indexOf(":")&&(u.push({name:r,value:l}),a.removeAttribute(r))}for(d=0,n=u.length;d<n;d++)(i=t.createAttribute(u[d].name.replace(":","_dt_b_namespace_token_"))).value=u[d].value,a.setAttributeNode(i)}p=m.serializeToString(t),p=(p=f?(p=-1===p.indexOf("<?xml")?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+p:p).replace(/_dt_b_namespace_token_/g,":"):p).replace(/<row xmlns="" /g,"<row ").replace(/<cols xmlns="">/g,"<cols>").replace(/<mergeCells xmlns="" /g,"<mergeCells ").replace(/<numFmt xmlns="" /g,"<numFmt ").replace(/<xf xmlns="" /g,"<xf "),o.file(e,p)}})},excelStrings:{"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="7"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/><numFmt numFmtId="170" formatCode="yyyy/mm/dd;@"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="68"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="170" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="49" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},excelParsers:[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(e){return e/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(e){return e/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64},{match:/^\d{4}\-\d{2}\-\d{2}$/,style:67},{match:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/gi,style:4}],addExcelStyle:function(e,t,r,l){t=M.extend({numFmtId:"0",fontId:"0",fillId:"0",borderId:"0",applyFont:"1",applyFill:"1",applyBorder:"1",xfId:"0",applyNumberFormat:"0",applyAlignment:"0"},t||{}),r=M.extend({horizontal:"left",indent:"0",shrinkToFit:"1",textRotation:"0",vertical:"center",wrapText:"0"},r||{}),M.isEmptyObject(e)&&(e.excel_parsers=!0);var o,a,d,n,i=l.getElementsByTagName("numFmts")[0],p=l.getElementsByTagName("cellXfs")[0],s=null,m=null;for(o in e)e.hasOwnProperty(o)&&(-1!==o.indexOf("format")&&(s=o),-1!==o.indexOf("style"))&&(m=o);return m&&!e[m]&&(a=n=0,s&&e[s]&&(d=M(i.getElementsByTagName("numFmt")),M.each(d,function(e,t){n++,a=Math.max(a,parseInt(M(t).attr("numFmtId"),10))}),d=M.jgrid.makeNode(l,"numFmt",{attr:{numFmtId:a+1,formatCode:e[s]}}),i.appendChild(d),M(i).attr("count",n+1)),i=0!==a?a+1+"":"0",n=0,t.numFmtId=i,d="1"===t.applyAlignment?M.jgrid.makeNode(l,"xf",{attr:t,children:[M.jgrid.makeNode(l,"alignment",{attr:r})]}):M.jgrid.makeNode(l,"xf",{attr:t}),p.appendChild(d),n=parseInt(M(p).attr("count"),10),M(p).attr("count",n+1),e[m]=n+1),e}}),M.jgrid.extend({exportToCsv:function(T){T=M.extend(!0,{separator:",",separatorReplace:" ",quote:'"',escquote:'"',newLine:"\r\n",replaceNewLine:" ",includeCaption:!0,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.csv",mimetype:"text/csv;charset=utf-8",returnAsString:!1,onBeforeExport:null,treeindent:" ",visibleTreeNodes:!1,loadIndicator:!0},T||{});var k="";if(this.each(function(){T._regexsep=new RegExp(T.separator,"g"),T._regexquot=new RegExp(T.quote,"g");var e,t,w=this,r=w.p.treeGrid?M(w).jqGrid("getRowData",null,!0,T.treeindent,T.visibleTreeNodes):w.addLocalData(!0),l=r.length,o=w.p.colModel,a=o.length,d=w.p.colNames,n=0,i="",p="",s="",m="",f="",u=[],c="";function g(s,m){var f="",u=w.p.groupingView,c=[],g=u.groupField.length,y=w.p.colModel,h=y.length,x=0;function I(e,t,r,l){for(var o,a,d=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),n=d.cnt,i=new Array(m.collen),p=0,s=l;s<h;s++)y[s]._excol&&(a="{0}",M.each(d.summary,function(){if(this.nm===y[s].name){y[s].summaryTpl&&(a=y[s].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<n&&(this.v=this.v/n));try{this.groupCount=d.cnt,this.groupIndex=d.dataIndex,this.groupValue=d.value,o=this.v}catch(e){o=this.v}return i[p]=M.jgrid.formatCellCsv(M.jgrid.stripHtml(M.jgrid.template(a,o)),m),!1}}),p++);return i}M.each(y,function(e,t){for(var r=0;r<g;r++)if(u.groupField[r]===t.name){c[r]=e;break}});var F,b,v=M.makeArray(u.groupSummary);if(v.reverse(),"local"===w.p.datatype&&!w.p.loadonce){M(w).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<l;t++)e.call(M(w),r[t],t)}return M.each(u.groups,function(e,t){x++;try{F=Array.isArray(u.formatDisplayField)&&M.jgrid.isFunction(u.formatDisplayField[t.idx])?u.formatDisplayField[t.idx].call(w,t.displayValue,t.value,w.p.colModel[c[t.idx]],t.idx,u):w.formatter("",t.displayValue,c[t.idx],t.value)}catch(e){F=t.displayValue}var r,l="";if("string"!=typeof(l=M.jgrid.isFunction(u.groupText[t.idx])?u.groupText[t.idx].call(w,F,t.cnt,t.summary):M.jgrid.template(u.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof l&&(l=F),(r="header"===u.groupSummaryPos[t.idx]?I(e,0,u.groups,0):new Array(m.collen))[0]=M.jgrid.formatCellCsv(M.jgrid.stripHtml(l),m),f+=r.join(m.separator)+m.newLine,g-1===t.idx){for(var o,a,d,n=u.groups[e+1],l=t.startRow,i=void 0!==n?n.startRow:u.groups[e].startRow+u.groups[e].cnt,p=l;p<i&&s[+p];p++){for(a=s[+p],o=b=0;o<y.length;o++)y[o]._expcol&&(r[b]=M.jgrid.formatCellCsv(M.jgrid.formatCell(M.jgrid.getAccessor(a,y[o].name),o,a,y[o],w,"csv"),m),b++);f+=r.join(m.separator)+m.newLine}if("header"!==u.groupSummaryPos[t.idx]){if(void 0!==n){for(d=0;d<u.groupField.length&&n.dataIndex!==u.groupField[d];d++);x=u.groupField.length-d}for(o=0;o<x;o++)v[o]&&(r=I(e,o,u.groups,0),f+=r.join(m.separator)+m.newLine);x=d}}}),f}M.jgrid.isFunction(T.loadIndicator)?T.loadIndicator("show"):T.loadIndicator&&M(w).jqGrid("progressBar",{method:"show",loadtype:w.p.loadui,htmlcontent:M.jgrid.getRegional(w,"defaults.loadtext")});var y=[];if(M.each(o,function(e,t){t._expcol=!0,void 0===t.exportcol?t.hidden&&(t._expcol=!1):t._expcol=t.exportcol,"cb"!==t.name&&"rn"!==t.name&&"subgrid"!==t.name&&"sc"!==t.name||(t._expcol=!1),t._expcol&&(u.push(M.jgrid.formatCellCsv(d[e],T)),y.push(t.name))}),T.includeLabels&&(f=u.join(T.separator)+T.newLine),T.collen=u.length,w.p.grouping){var h=!!w.p.groupingView._locgr;w.p.groupingView._locgr=!1,i+=g(r,T),w.p.groupingView._locgr=h}else for(;n<l;){for(e=r[n],b=[],I=t=0;I<a;I++)o[I]._expcol&&(b[t]=M.jgrid.formatCellCsv(M.jgrid.formatCell(M.jgrid.getAccessor(e,o[I].name),I,e,o[I],w,"csv"),T),t++);i+=b.join(T.separator)+T.newLine,n++}if(r=null,b=new Array(T.collen),T.includeCaption&&w.p.caption){for(n=T.collen;--n;)b[n]="";b[0]=M.jgrid.formatCellCsv(w.p.caption,T),p+=b.join(T.separator)+T.newLine}if(T.includeGroupHeader&&M(w).jqGrid("isGroupHeaderOn"))for(var x=w.p.groupHeader,I=0;I<x.length;I++){for(var F=x[I].groupHeaders,n=0,b=[],v=0;v<y.length;v++){for(b[n]="",t=0;t<F.length;t++)F[t].startColumnName===y[v]&&(b[n]=M.jgrid.formatCellCsv(F[t].titleText,T));n++}s+=b.join(T.separator)+T.newLine}if(T.includeFooter&&w.p.footerrow&&M(".ui-jqgrid-ftable",this.sDiv).length){var j=M(w).jqGrid("footerData","get");for(I=0,b=[];I<T.collen;){var C=y[I];j.hasOwnProperty(C)&&b.push(M.jgrid.formatCellCsv(M.jgrid.stripHtml(j[C]),T)),I++}m+=b.join(T.separator)+T.newLine}if(T.includeHeader&&w.p.headerrow){var _=M(w).jqGrid("headerData","get");for(I=0,b=[];I<T.collen;){var B=y[I];_.hasOwnProperty(B)&&b.push(M.jgrid.formatCellCsv(M.jgrid.stripHtml(_[B]),T)),I++}c+=b.join(T.separator)+T.newLine}k=p+s+f+c+i+m,M.jgrid.isFunction(T.loadIndicator)?T.loadIndicator("hide"):T.loadIndicator&&M(w).jqGrid("progressBar",{method:"hide",loadtype:w.p.loadui})}),T.returnAsString)return k;if(-1!==T.mimetype.toUpperCase().indexOf("UTF-8")&&(k="\ufeff"+k),M.jgrid.isFunction(T.onBeforeExport)&&!(k=T.onBeforeExport(k)))throw"Before export does not return data!";M.jgrid.saveAs(k,T.fileName,{type:T.mimetype})},exportToExcel:function(R){R=M.extend(!0,{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.xlsx",mimetype:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",maxlength:40,onBeforeExport:null,customizeData:null,replaceStr:null,treeindent:" ",visibleTreeNodes:!1,loadIndicator:!0},R||{}),this.each(function(){for(var e,t,F=this,r=M.jgrid.excelStrings,g=0,y=M.parseXML(r["xl/worksheets/sheet1.xml"]),G=y.getElementsByTagName("sheetData")[0],l=M.parseXML(r["xl/styles.xml"]),r=(l.getElementsByTagName("numFmts")[0],l.getElementsByTagName("cellXfs")[0],{_rels:{".rels":M.parseXML(r["_rels/.rels"])},xl:{_rels:{"workbook.xml.rels":M.parseXML(r["xl/_rels/workbook.xml.rels"])},"workbook.xml":M.parseXML(r["xl/workbook.xml"]),"styles.xml":l,worksheets:{"sheet1.xml":y}},"[Content_Types].xml":M.parseXML(r["[Content_Types].xml"])}),b=F.p.colModel,o=0,v={body:F.p.treeGrid?M(F).jqGrid("getRowData",null,!0,R.treeindent,R.visibleTreeNodes):F.addLocalData(!0),header:[],footer:[],width:[],map:[],parser:[],labels:[]},E=M.jgrid.addExcelStyle({excel_header_style:""},{fontId:"2",applyAlignment:"1"},{horizontal:"center",vertical:"center"},l).excel_header_style,a=0,d=b.length;a<d;a++)b[a]._expcol=!0,void 0===b[a].exportcol?b[a].hidden&&(b[a]._expcol=!1):b[a]._expcol=b[a].exportcol,"cb"!==b[a].name&&"rn"!==b[a].name&&"subgrid"!==b[a].name&&b[a]._expcol&&"sc"!==b[a].name&&(v.header[o]=b[a].name,v.width[o]=5,v.map[o]=a,v.labels[o]=F.p.colNames[a],b[a].hasOwnProperty("exportoptions")?(e={},t={},b[a].exportoptions.excel_format&&(e=M.jgrid.addExcelStyle({excel_format:b[a].exportoptions.excel_format,excel_style:b[a].exportoptions.excel_style||""},{},{},l)),b[a].exportoptions.excel_header_format&&(t=M.jgrid.addExcelStyle({excel_header_format:b[a].exportoptions.excel_header_format,excel_header_style:b[a].exportoptions.excel_header_style||""},{fontId:"2",applyAlignment:"1"},{horizontal:"center"},l)),v.parser[a]=M.extend(e,t),b[a].exportoptions.replace_format&&(v.parser[a].replace_format=b[a].exportoptions.replace_format),b[a].exportoptions.replace_header_format&&(v.parser[a].replace_header_format=b[a].exportoptions.replace_header_format)):v.parser[a]={excel_parsers:!0},o++);if(R.includeFooter||F.p.footerrow)for(o in v.footer=M(F).jqGrid("footerData","get"),v.footer)v.footer.hasOwnProperty(o)&&(v.footer[o]=M.jgrid.stripHtml(v.footer[o]));function h(e,t){return M.jgrid.makeNode(y,"c",{attr:e,children:[M.jgrid.makeNode(y,"v",{text:t})]})}function x(e,t,r){return M.jgrid.makeNode(y,"c",{attr:{t:"inlineStr",r:e,s:r=void 0===r?68:r},children:{row:M.jgrid.makeNode(y,"is",{children:{row:M.jgrid.makeNode(y,"t",{text:t})}})}})}M.jgrid.isFunction(R.customizeData)&&R.customizeData.call(F,v);var I,w,j=M.jgrid.isFunction(R.replaceStr)?R.replaceStr:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"")},C=function(e,t,r){void 0===r&&(r=!1),I=g+1,w=M.jgrid.makeNode(y,"row",{attr:{r:I}});for(var l,o,a=0;a<v.header.length;a++){var d,n,i=M.jgrid.excelCellPos(a)+""+I,p=(null==(c=Array.isArray(e)&&t?v.labels[a]:M.jgrid.getAccessor(e,v.header[a]))&&(c=""),t||(c=M.jgrid.formatCell(c,v.map[a],e,b[v.map[a]],F,"excel"))&&("&nbsp;"===c||"&#160;"===c||1===c.length&&160===c.charCodeAt(0))&&(c=""),v.width[a]=Math.max(v.width[a],Math.min(parseInt(c.toString().length,10),R.maxlength)),d=null,v.parser[v.map[a]]);if(t&&r)p.replace_header_format&&(c=p.replace_header_format(c)),d=void 0!==p.excel_header_style?"text"===p.excel_header_style?x(i,c):p.excel_header_style<=55?x(i,c,p.excel_header_style):h({r:i,s:p.excel_header_style},c):x(i,c,E),w.appendChild(d);else if(!0!==p.excel_parsers||d)void 0===p.excel_style||t||d||(p.replace_format&&(c=p.replace_format(c)),d="text"===p.excel_style?x(i,c):p.excel_style<=55?x(i,c,p.excel_style):h({r:i,s:p.excel_style},c),w.appendChild(d));else for(var s=0,m=M.jgrid.excelParsers.length;s<m;s++){var f=M.jgrid.excelParsers[s];if(c.match&&!c.match(/^0\d+/)&&c.match(f.match)){var u=c,c=c.replace(/[^\d\.\-]/g,"");if(f.fmt&&(c=f.fmt(c)),67===f.style)d=h({t:"d",r:i,s:f.style},c);else if(4===f.style)l=u,o=void 0,(o=document.createElement("div")).innerHTML=l,d=(c="A"===(l=o.firstChild).nodeName?[l.href,l.text]:"#text"===l.nodeName&&[l.textContent,l.textContent])?(o={t:"str",r:i,s:f.style},l='HYPERLINK("'+c[0]+'","'+c[1]+'")',M.jgrid.makeNode(y,"c",{attr:o,children:[M.jgrid.makeNode(y,"f",{text:l})]})):x(i,u);else{if(M.inArray(f.style,["63","64","65","66"])&&15<c.toString().length){d=x(i,u.replace?j(u):u),w.appendChild(d);break}d=h({r:i,s:f.style},c)}w.appendChild(d);break}}d||(c.match&&(n=c.match(/^-?([1-9]\d+)(\.(\d+))?$/)),d="number"==typeof c&&c.toString().length<=15||n&&n[1].length+(n[2]?n[3].length:0)<=15?h({t:"n",r:i},c):x(i,c.replace?j(c):c),w.appendChild(d))}G.appendChild(w),g++};function L(s){var m=F.p.groupingView,f=[],u=m.groupField.length,c=b.length,g=0;function y(e,t,r,l){for(var o,a,d=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),n=d.cnt,i=h(v.header),p=l;p<c;p++)b[p]._expcol&&(a="{0}",M.each(d.summary,function(){if(this.nm===b[p].name){b[p].summaryTpl&&(a=b[p].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<n&&(this.v=this.v/n));try{this.groupCount=d.cnt,this.groupIndex=d.dataIndex,this.groupValue=d.value,o=this.v}catch(e){o=this.v}return i[this.nm]=M.jgrid.stripHtml(M.jgrid.template(a,o)),!1}}));return i}function h(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}M.each(b,function(e,t){for(var r=0;r<u;r++)if(m.groupField[r]===t.name){f[r]=e;break}});var x,I=M.makeArray(m.groupSummary);if(I.reverse(),"local"===F.p.datatype&&!F.p.loadonce){M(F).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<v.body.length;t++)e.call(M(F),v.body[t],t)}M.each(m.groups,function(e,t){g++;try{x=Array.isArray(m.formatDisplayField)&&M.jgrid.isFunction(m.formatDisplayField[t.idx])?m.formatDisplayField[t.idx].call(F,t.displayValue,t.value,F.p.colModel[f[t.idx]],t.idx,m):F.formatter("",t.displayValue,f[t.idx],t.value)}catch(e){x=t.displayValue}var r="",l=("string"!=typeof(r=M.jgrid.isFunction(m.groupText[t.idx])?m.groupText[t.idx].call(F,x,t.cnt,t.summary):M.jgrid.template(m.groupText[t.idx],x,t.cnt,t.summary))&&"number"!=typeof r&&(r=x),"header"===m.groupSummaryPos[t.idx]?y(e,0,m.groups,0):h(v.header));if(l[Object.keys(l)[0]]=M.jgrid.stripHtml(new Array(5*t.idx).join(" ")+r),C(l,!1),u-1===t.idx){for(var o,a,d=m.groups[e+1],r=t.startRow,n=void 0!==d?d.startRow:m.groups[e].startRow+m.groups[e].cnt,i=r;i<n&&s[+i];i++){var p=s[+i];C(p,!1)}if("header"!==m.groupSummaryPos[t.idx]){if(void 0!==d){for(a=0;a<m.groupField.length&&d.dataIndex!==m.groupField[a];a++);g=m.groupField.length-a}for(o=0;o<g;o++)I[o]&&(l=y(e,o,m.groups,0),C(l,!1));g=a}}})}if(M.jgrid.isFunction(R.loadIndicator)?R.loadIndicator("show"):R.loadIndicator&&M(F).jqGrid("progressBar",{method:"show",loadtype:F.p.loadui,htmlcontent:M.jgrid.getRegional(F,"defaults.loadtext")}),M("sheets sheet",r.xl["workbook.xml"]).attr("name",R.sheetName),R.includeGroupHeader&&M(F).jqGrid("isGroupHeaderOn")){for(var n,i=F.p.groupHeader,p=[],s=0,m=0;m<i.length;m++){var f=i[m].groupHeaders,u={},c=i[m].useColSpanStyle&&1===i.length,_=[];for(s++,a=a=0;a<v.header.length;a++){u[n=v.header[a]]=c?v.labels[a]:"";for(var B=-1,T=-1,k=0;k<f.length;k++)if(f[k].startColumnName===n&&(u[n]=f[k].titleText,B=M.jgrid.excelCellPos(a)+s,T=M.jgrid.excelCellPos(a+f[k].numberOfColumns-1)+s,p.push({ref:B+":"+T}),c))for(var N=a+1;N<a+f[k].numberOfColumns;N++)_.push(N);-1===B&&-1===T&&c&&-1===_.indexOf(a)&&(B=M.jgrid.excelCellPos(a)+s,T=M.jgrid.excelCellPos(a)+(s+1),p.push({ref:B+":"+T}))}C(u,!0,!0)}var S=M.jgrid.makeNode(y,"mergeCells",{attr:{count:p.length}});for(M("worksheet",y).append(S),o=0;o<p.length;o++)S.appendChild(M.jgrid.makeNode(y,"mergeCell",{attr:p[o]}))}if(R.includeLabels&&C(v.header,!0,!0),R.includeHeader||F.p.headerrow){var A=M(F).jqGrid("headerData","get");for(o in A)A.hasOwnProperty(o)&&(A[o]=M.jgrid.stripHtml(A[o]));M.isEmptyObject(A)||(C(A,!0),M("row",y).last().find("c").attr("s","2"))}if(F.p.grouping){var P=!!F.p.groupingView._locgr;F.p.groupingView._locgr=!1,L(v.body),F.p.groupingView._locgr=P}else for(var H=0,V=v.body.length;H<V;H++)C(v.body[H],!1);!R.includeFooter&&!F.p.footerrow||M.isEmptyObject(v.footer)||(C(v.footer,!0),M("row",y).last().find("c").attr("s","2"));var D=M.jgrid.makeNode(y,"cols");for(M("worksheet",y).prepend(D),o=0,d=v.width.length;o<d;o++)D.appendChild(M.jgrid.makeNode(y,"col",{attr:{min:o+1,max:o+1,width:v.width[o],customWidth:1}}));M.jgrid.isFunction(R.onBeforeExport)&&R.onBeforeExport(r,g),v=null;try{var q=new JSZip,O={type:"blob",mimeType:R.mimetype};M.jgrid.xmlToZip(q,r),q.generateAsync?q.generateAsync(O).then(function(e){M.jgrid.saveAs(e,R.fileName,{type:R.mimetype})}):M.jgrid.saveAs(q.generate(O),R.fileName,{type:R.mimetype})}catch(e){throw e}finally{M.jgrid.isFunction(R.loadIndicator)?R.loadIndicator("hide"):R.loadIndicator&&M(F).jqGrid("progressBar",{method:"hide",loadtype:F.p.loadui})}})},exportToPdf:function(b){return b=M.extend(!0,{title:null,orientation:"portrait",pageSize:"A4",description:null,onBeforeExport:null,download:"download",includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.pdf",mimetype:"application/pdf",treeindent:"-",visibleTreeNodes:!1,loadIndicator:!0},b||{}),this.each(function(){var e,t,r,v=this,w=[],l=v.p.colModel,a={},d=v.p.treeGrid?M(v).jqGrid("getRowData",null,!0,b.treeindent,b.visibleTreeNodes):v.addLocalData(!0),j=[],n=0,i=[],o=[],p=[],C={};function s(s){var m=v.p.groupingView,f=[],u=m.groupField.length,c=v.p.colModel,g=c.length,y=0;function h(e,t){for(var r=0,l=[],o=0;o<j.length;o++)a={text:null==e[j[o]]?"":t?M.jgrid.formatCell(e[j[o]]+"",i[r],d[n],c[i[r]],v,"pdf"):e[j[o]],alignment:C[o],style:"tableBody"},l.push(a),r++;return l}function x(e,t,r,l){for(var o,a,d=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),n=d.cnt,i=I(j),p=l;p<g;p++)c[p]._expcol&&(a="{0}",M.each(d.summary,function(){if(this.nm===c[p].name){c[p].summaryTpl&&(a=c[p].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<n&&(this.v=this.v/n));try{this.groupCount=d.cnt,this.groupIndex=d.dataIndex,this.groupValue=d.value,o=this.v}catch(e){o=this.v}return i[this.nm]=M.jgrid.stripHtml(M.jgrid.template(a,o)),!1}}));return i}function I(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}M.each(c,function(e,t){for(var r=0;r<u;r++)if(m.groupField[r]===t.name){f[r]=e;break}});var F,b=M.makeArray(m.groupSummary);if(b.reverse(),"local"===v.p.datatype&&!v.p.loadonce){M(v).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<d.length;t++)e.call(M(v),d[t],t)}M.each(m.groups,function(e,t){y++;try{F=Array.isArray(m.formatDisplayField)&&M.jgrid.isFunction(m.formatDisplayField[t.idx])?m.formatDisplayField[t.idx].call(v,t.displayValue,t.value,v.p.colModel[f[t.idx]],t.idx,m):v.formatter("",t.displayValue,f[t.idx],t.value)}catch(e){F=t.displayValue}var r="",l=("string"!=typeof(r=M.jgrid.isFunction(m.groupText[t.idx])?m.groupText[t.idx].call(v,F,t.cnt,t.summary):M.jgrid.template(m.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof r&&(r=F),"header"===m.groupSummaryPos[t.idx]?x(e,0,m.groups,0):I(j));if(l[Object.keys(l)[0]]=M.jgrid.stripHtml(new Array(5*t.idx).join(" ")+r),w.push(h(l,!0)),u-1===t.idx){for(var o,a,d=m.groups[e+1],r=t.startRow,n=void 0!==d?d.startRow:m.groups[e].startRow+m.groups[e].cnt,i=r;i<n&&s[+i];i++){var p=s[+i];w.push(h(p,!0))}if("header"!==m.groupSummaryPos[t.idx]){if(void 0!==d){for(a=0;a<m.groupField.length&&d.dataIndex!==m.groupField[a];a++);y=m.groupField.length-a}for(o=0;o<y;o++)b[o]&&(l=x(e,o,m.groups,0),w.push(h(l,!0)));y=a}}})}for(M.jgrid.isFunction(b.loadIndicator)?b.loadIndicator("show"):b.loadIndicator&&M(v).jqGrid("progressBar",{method:"show",loadtype:v.p.loadui,htmlcontent:M.jgrid.getRegional(v,"defaults.loadtext")}),e=0,x=l.length;e<x;e++)l[e]._expcol=!0,void 0===l[e].exportcol?l[e].hidden&&(l[e]._expcol=!1):l[e]._expcol=l[e].exportcol,"cb"!==l[e].name&&"rn"!==l[e].name&&"subgrid"!==l[e].name&&"sc"!==l[e].name&&l[e]._expcol&&(a={text:v.p.colNames[e],style:"tableHeader"},o.push(a),j[n]=l[e].name,i[n]=e,p.push(l[e].width),C[l[e].name]=l[e].align||"left",n++);if(b.includeGroupHeader&&M(v).jqGrid("isGroupHeaderOn"))for(r=v.p.groupHeader,n=0;n<r.length;n++){for(var m=[],f=r[n].groupHeaders,u=r[n].useColSpanStyle,c=0;c<j.length;c++){for(a=u?{text:v.p.colNames[c],style:"tableHeader",rowSpan:2,verticalAlign:"center"}:{text:"",style:"tableHeader"},t=0;t<f.length;t++)f[t].startColumnName===j[c]&&(a={text:f[t].titleText,colSpan:f[t].numberOfColumns,style:"tableHeader"});m.push(a),e++}w.push(m)}if(b.includeLabels&&w.push(o),b.includeHeader&&v.p.headerrow){var g=M(v).jqGrid("headerData","get"),o=[];for(c=0;c<j.length;c++)a={text:M.jgrid.stripHtml(M.jgrid.getAccessor(g,j[c])),style:"tableFooter",alignment:C[j[c]]},o.push(a);w.push(o)}if(v.p.grouping){var y=!!v.p.groupingView._locgr;v.p.groupingView._locgr=!1,s(d),v.p.groupingView._locgr=y}else for(var h,n=0,x=d.length;n<x;n++){for(o=[],h=d[n],c=t=0;c<j.length;c++)a={text:null==h[j[c]]?"":M.jgrid.stripHtml(M.jgrid.formatCell(M.jgrid.getAccessor(h,j[c])+"",i[t],d[n],l[i[t]],v,"pdf")),alignment:C[j[c]],style:"tableBody"},o.push(a),t++;w.push(o)}if(b.includeFooter&&v.p.footerrow){var I=M(v).jqGrid("footerData","get");for(o=[],c=0;c<j.length;c++)a={text:M.jgrid.stripHtml(M.jgrid.getAccessor(I,j[c])),style:"tableFooter",alignment:C[j[c]]},o.push(a);w.push(o)}y={pageSize:b.pageSize,pageOrientation:b.orientation,content:[{style:"tableExample",widths:p,table:{headerRows:null!=r?0:1,body:w}}],styles:{tableHeader:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc",alignment:"center"},tableBody:{fontSize:10},tableFooter:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc"},title:{alignment:"center",fontSize:15},description:{}},defaultStyle:{fontSize:10}};b.description&&y.content.unshift({text:b.description,style:"description",margin:[0,0,0,12]}),b.title&&y.content.unshift({text:b.title,style:"title",margin:[0,0,0,12]}),M.jgrid.isFunction(b.onBeforeExport)&&b.onBeforeExport.call(v,y);try{var F=pdfMake.createPdf(y);F.getDataUrl(function(e){M.jgrid.isFunction(b.loadIndicator)?b.loadIndicator("hide"):b.loadIndicator&&M(v).jqGrid("progressBar",{method:"hide",loadtype:v.p.loadui})}),"open"===b.download?F.open():F.getBuffer(function(e){M.jgrid.saveAs(e,b.fileName,{type:b.mimetype})})}catch(e){throw e}})},exportToHtml:function(s){var f;return s=M.extend(!0,{title:"",onBeforeExport:null,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,tableClass:"jqgridprint",autoPrint:!1,topText:"",bottomText:"",returnAsString:!1,treeindent:"&nbsp;",visibleTreeNodes:!1,loadIndicator:!0},s||{}),this.each(function(){var v=this,m=v.p.colModel,e=0,w={body:v.p.treeGrid?M(v).jqGrid("getRowData",null,!0,s.treeindent,s.visibleTreeNodes):v.addLocalData(!0),header:[],footer:[],width:[],map:[],align:[]},t=0;for(n=m.length;t<n;t++)m[t]._expcol=!0,void 0===m[t].exportcol?m[t].hidden&&(m[t]._expcol=!1):m[t]._expcol=m[t].exportcol,"cb"!==m[t].name&&"rn"!==m[t].name&&"subgrid"!==m[t].name&&"sc"!==m[t].name&&m[t]._expcol&&(w.header[e]=m[t].name,w.width[e]=m[t].width,w.map[e]=t,w.align[e]=m[t].align||"left",e++);var r=document.createElement("a"),l=function(e){r.href=e;e=r.host;return-1===e.indexOf("/")&&0!==r.pathname.indexOf("/")&&(e+="/"),r.protocol+"//"+e+r.pathname+r.search},j=function(e,t,r,l,o){for(var a,d,n="<tr>",i=0,p=w.header.length;i<p&&(d=o?' colspan= "'+w.header.length+'" style=text-align:left':!0===l?" style=width:"+w.width[i]+"px;text-align:"+w.align[i]+";":" style=text-align:"+w.align[i]+";",a=w.header[i],e.hasOwnProperty(a)&&(n+="<"+t+d+">"+(r?M.jgrid.formatCell(M.jgrid.getAccessor(e,a),w.map[i],e,m[w.map[i]],v,"html"):e[a])+"</"+t+">"),!o);i++);return n+"</tr>"};function o(f){var u=v.p.groupingView,c=[],g=u.groupField.length,s=m.length,y=0,h="";function x(e,t,r,l){for(var o,a,d=function(e,t,r){var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o}(e,t,r),n=d.cnt,i=I(w.header),p=l;p<s;p++)m[p]._expcol&&(a="{0}",M.each(d.summary,function(){if(this.nm===m[p].name){m[p].summaryTpl&&(a=m[p].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&0<n&&(this.v=this.v/n));try{this.groupCount=d.cnt,this.groupIndex=d.dataIndex,this.groupValue=d.value,o=this.v}catch(e){o=this.v}return i[this.nm]=M.jgrid.stripHtml(M.jgrid.template(a,o)),!1}}));return i}function I(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}M.each(m,function(e,t){for(var r=0;r<g;r++)if(u.groupField[r]===t.name){c[r]=e;break}});var F,b=M.makeArray(u.groupSummary);if(b.reverse(),"local"===v.p.datatype&&!v.p.loadonce){M(v).jqGrid("groupingSetup");for(var e=M.jgrid.getMethod("groupingPrepare"),t=0;t<w.body.length;t++)e.call(M(v),w.body[t],t)}return M.each(u.groups,function(e,t){y++;try{F=Array.isArray(u.formatDisplayField)&&M.jgrid.isFunction(u.formatDisplayField[t.idx])?u.formatDisplayField[t.idx].call(v,t.displayValue,t.value,v.p.colModel[c[t.idx]],t.idx,u):v.formatter("",t.displayValue,c[t.idx],t.value)}catch(e){F=t.displayValue}var r="";"string"!=typeof(r=M.jgrid.isFunction(u.groupText[t.idx])?u.groupText[t.idx].call(v,F,t.cnt,t.summary):M.jgrid.template(u.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof r&&(r=F);var l,o=!1,a=("header"===u.groupSummaryPos[t.idx]?l=x(e,0,u.groups,0):(l=I(w.header),o=!0),Object.keys(l));if(l[a[0]]=new Array(5*t.idx).join(" ")+r,h+=j(l,"td",!0,1===y,o),g-1===t.idx){for(var d,n,i=u.groups[e+1],a=t.startRow,p=void 0!==i?i.startRow:u.groups[e].startRow+u.groups[e].cnt,s=a;s<p&&f[+s];s++){var m=f[+s];h+=j(m,"td",!0)}if("header"!==u.groupSummaryPos[t.idx]){if(void 0!==i){for(n=0;n<u.groupField.length&&i.dataIndex!==u.groupField[n];n++);y=u.groupField.length-n}for(d=0;d<y;d++)b[d]&&(l=x(e,d,u.groups,0),h+=j(l,"td",!0));y=n}}}),h}M.jgrid.isFunction(s.loadIndicator)?s.loadIndicator("show"):s.loadIndicator&&M(v).jqGrid("progressBar",{method:"show",loadtype:v.p.loadui,htmlcontent:M.jgrid.getRegional(v,"defaults.loadtext")});var a='<table class="'+s.tableClass+'">';if(s.includeLabels&&(a+="<thead>"+function(e,t,r){for(var l="<tr>",o=0,a=e.length;o<a;o++)l+="<"+t+(!0===r?" style=width:"+w.width[o]+"px;":"")+">"+v.p.colNames[w.map[o]]+"</"+t+">";return l+"</tr>"}(w.header,"th",!0)+"</thead>"),a+="<tbody>",s.includeHeader&&v.p.headerrow&&(d=M(v).jqGrid("headerData","get",null,!1),a+=j(d,"td",!1)),v.p.grouping){var d=!!v.p.groupingView._locgr;v.p.groupingView._locgr=!1,a+=o(w.body),v.p.groupingView._locgr=d}else for(var e=0,n=w.body.length;e<n;e++)a+=j(w.body[e],"td",!0,0===e);if(s.includeFooter&&v.p.footerrow&&(w.footer=M(v).jqGrid("footerData","get",null,!1),a+=j(w.footer,"td",!1)),a=a+"</tbody>"+"</table>",s.returnAsString)f=a;else{var i=window.open("",""),p=(i.document.close(),s.title?"<title>"+s.title+"</title>":"");M("style, link").each(function(){p+=function(e){e=M(e).clone()[0];return"link"===e.nodeName.toLowerCase()&&(e.href=l(e.href)),e.outerHTML}(this)});try{i.document.head.innerHTML=p}catch(e){M(i.document.head).html(p)}i.document.body.innerHTML=(s.title?"<h1>"+s.title+"</h1>":"")+"<div>"+(s.topText||"")+"</div>"+a+"<div>"+(s.bottomText||"")+"</div>",M(i.document.body).addClass("html-view"),M("img",i.document.body).each(function(e,t){t.setAttribute("src",l(t.getAttribute("src")))}),s.onBeforeExport&&s.onBeforeExport(i),Boolean(i.chrome)?s.autoPrint&&(i.print(),i.close()):setTimeout(function(){s.autoPrint&&(i.print(),i.close())},1e3)}M.jgrid.isFunction(s.loadIndicator)?s.loadIndicator("hide"):s.loadIndicator&&M(v).jqGrid("progressBar",{method:"hide",loadtype:v.p.loadui})}),f}})});